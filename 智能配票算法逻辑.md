# 业务目标
在票据池中选出不超过最大张数限制的票据子集（组合），使组合的总金额尽可能接近付款单金额M（接近的含义是可大于M也可小于M，大于M时做拆票，小于M时候可拆票可组合电汇补齐尾差），同时满足配票偏好、目标权重配置、拆票规则和约束条件。

# 目标函数
最大化偏好得分作为目标函数，选出最优票据组合（偏好得分最高）

# 票据可用范围
票据到期期限：可选项，如票据金额大于/等于/小于100W；
票据金额：可选项， 按月份，如大于等于3月或者当月； 按天，如大于30天；
票据承兑人分类：可选项，1～n类

# 票据标签
大额：金额范围mp1，期望库存占比sp1
中额：金额范围mp2，期望库存占比sp2
小额：金额范围mp3，期望库存占比sp3

# 选票偏好设置
是否优先等额配票（优先匹配和付款单金额等额或者接近的票据，当有多张候选等额票时，需要按照目标权重配置中的票据排序择优选取一个），可选项；
是否允许拆票，可选项；
最高权重维度是否强制穿透（如果强制穿透，则该维度不允许跨级用票，严格遵循配置的优先级用票，比如当设置了优先承兑人分类差的为最高权重，必须差的用完再用好的票。如果设置承兑人分类好的为最高权重，必须好的用完再用差的票。），可选项；

# 权重维度（w1+w2+w3+w4=1）
票据到期期策略：（w1）：可选项，可选值：【"优先远-天数阈值T_far"，"优先近-天数阈值T_near"）】
承兑人分类(w2)：可选项，可选值【优先承兑人分类好的，优先承兑人分类差的】
票据金额策略(w3)：可选项，可选值【大额优先、小额优先、金额随机、整票金额小于等于付款单金额、单票金额大于等于付款单金额、优化期望库存占比】
        • 如果金额策略=优化期望库存票据占比，则根据票据类型的库存分布和用户期望库存分布，计算得到票据类型偏好。比如用户期望票据分布为：{大额": 0.5, "中额": 0.4 "小额": 0.1},实际初始库存分布为{大额": 0.3, "中额": 0.5 "小额": 0.2}，则大额、中额、小额票据的优先消耗顺序和权重为：中票（权重：(0.5+0.1)/（0.5+0.1+0.2+0.1））>小票（权重：(0.2+0.1)/(0.5+0.1+0.2+0.1)）>大票（权重：0）；
        • 如果金额策略=大额优先，子策略有两种可选，分别是：大额内随机/大额内从大到小排序进行选票，相应的票据得分越高。
        • 如果金额策略=小额优先，子策略有两种可选，分别是：小额内随机/小额内从小到大排序进行选票，相应的票据得分越高。
        • 如果金额策略=金额随机，则随机选择票据，所有票据得分一致；
        • 如果金额策略=整票金额小于等于付款单金额，则优选选择累计整票金额小于等于付款单金额的组合，相应的票据组合得分越高；
        • 如果金额策略=单票金额大于等于付款单金额，则优选选择单张票金额大于等于付款单金额的票据（期望最少用票），相应的票据得分越高；
承兑组织(w4)：可选项，可选值【优先匹配票据和付款单同组织票据、优先匹配票据和付款单不同组织票据】，相应的票据得分越高。


# 拆票规则（是否允许拆票=True时）
名词定义：
bias_amount：差额 = 付款单金额-当前票据总金额
tail_diff: 可选项，【尾差金额阈值（默认值1W），尾差占比域值（默认值30%）】
票据拆分条件：可选项，有两种类型，
1.无限制
2.差额范围内无需拆分：走电汇尾差补齐。判断条件：如果bias_amount（差额）大于0且bias_amount(差额) < tail_diff


# 票据拆分策略（拆分条件=无限制）:可选项
▪ 具体拆分规则： 
如果bias_amount（差额）大于0且bias_amount(差额) > tail_diff，则从票据池中选择一张新票进行拆分; 
如果bias_amount小于0，则从当前票据组合中选择一张票据进行拆分；拆票选票的策略遵循以下策略：
split_strategy：拆票选票策略，有三种维度： 分别是按到期期限、票据承兑人分类、票据金额维度。 其中票据到期期限、票据承兑人分类可以直接复用权重维度中的设置，票据金额维度可选大额优先和接近大于差额中的一种；

# 拆票约束：
票据拆分后结余（留存）金额大于等于某个范围）(默认值5万)；
票据拆分使用金额（差额）大于等于某个范围(默认值5万)；
票据拆分金额（使用金额）占整张票据比例大于某个值(默认值30%)；

# 票据数量约束
单张付款单做多可用票据张数： 可选项。是否允许浮动，张数可选项。
小额票张数是否有限制：可选项，如果有限制，需满足票据金额由小到大排序，前80%（张数）的票据累计金额必须要占据50%以上的的付款单金额的约束。
